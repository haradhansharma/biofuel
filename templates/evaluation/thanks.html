{% extends "includes/g_base.html" %}
<!DOCTYPE html>
<html lang="en">


<body>

    {% block header %}
    {% include 'includes/g_header.html' %}
    {% endblock %}


    {% block main %}
    <main>


        {% include "includes/hero_section.html" %}
        
        <div class="section pt-0">
            <div class="container mt-n10 mt-lg-n12 z-2">
                <div class="row justify-content-center">


                    {% if messages %}
                        
                        <div class="alert alert-secondary mt-5" role="alert">
                            {% for message in messages %}
                            <span class="alert-inner--text">{{ message }}</span>
                            {% endfor %}
                        </div>
                        
                    {% endif %}



                    <div class="col-12"> 
                        <div class="row">
                        <div class="col-12  col-lg-4 mb-4 ">
                            <div class="card border-0 shadow">
                                <div class="card-body">
                                    <div class="row d-block d-lg-flex align-items-center " style="min-height: 200px; overflow:hidden;">
                                        <img src="{{ user.type.icon.url }}" class="rounded-circle mx-auto d-block  w-50 img-fluid " alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-8 mb-4 ">  
                            <div class="card border-0 shadow">
                                <div class="card-body">
                                    <div class="row d-block d-xl-flex align-items-center" style="min-height: 200px;">
                                        <div class="col-12">  
                                            <div class="d-flex">
                                            <div class="col-6">  
                                                <h5>
                                                {% if user.get_full_name %} 
                                                
                                                    <span>{{ user.get_full_name }}</span>
                                                    {% else %} 
                                                There is no name 
                                                {% endif %} 
                                                <span>
                                                <a href="{% url 'home:user_settings' %}">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-supported-dps="24x24" fill="currentColor" class="mercado-match" width="24" height="24" focusable="false">
                                                        <path d="M21.13 2.86a3 3 0 00-4.17 0l-13 13L2 22l6.19-2L21.13 7a3 3 0 000-4.16zM6.77 18.57l-1.35-1.34L16.64 6 18 7.35z"></path>
                                                      </svg>                                                
                                                </a>
                                            </span>
                                                
                                                
                                            </h5>
                                            
                                        </div> 
                                             
                                            <div class="col-auto">
                                                <div class="text-info bg-dark d-flex">
                                                    {% if request.user.is_authenticated %}
                                                    {% if request.user.is_producer or request.user.is_staff or request.user.is_superuser %}
                                                    <a  href="{% url 'evaluation:evaluation2' %}" class="me-2">Begin Evaluating</a>
                                                    {% endif %}
                                                    {% if request.user.is_expert or request.user.is_staff or request.user.is_superuser %}
                                                    <a href="{% url 'home:questions' %}" class="me-2">Questions and Quotations</a>
                                                    {% endif %}
                                                   
                                                    {% endif %}
    
                                                </div> 
                                            </div> 

                                            
                                        
                                                
                                            </div>
                                            
                                            
                                            
                                                <hr> 
                                            <div class=" d-xl-flex">
                                                <div class="col-12 col-md-6 card  border-0 bg-transparent">                                 
                                                <h6> {{ user.type.name }} </h6>
                                                <h6> {% if user.is_expert %} ({{ user.experts_in.name }}) {% endif %}</h6>
                                                <h6>{% if user.orgonization %}{{ user.orgonization }}{% else %} There is no organization {% endif %} </h6>
                                            </div>  
                                            <div class="col-12 col-md-6 card  border-0 bg-transparent">
                                                <h6>{{ user.email }} </h6>
                                                 <h6>{% if user.phone %}{{ user.phone }}{% else %} There is no phone number {% endif %}</h6>
                                            </div>
                                        </div> 
                                        </div>                                        
                                    </div>
                                </div>
                                
                                
                            </div>
                        </div>  
                    </div>
                    </div>
                </div>




                <div id ="ques" class="row justify-content-center">
                    <div class="col-12"> 
                        <div class="card text-center">
                            <div class="card-header">
                                <h2>{{ gretings }}</h2>
                            </div>

                            <!--for last report -->
                            {% if last_reports  %}
                            <div class="row p-3">
                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">The number of questions you responded</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ ans_ques }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">Total number of "Don't know" responses.</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ dont_know_ans }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">The total number of positive responses received.</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ pos_ans }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">The Percentage of positive response.</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ positive_percent }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">Percentage of "Don't know" response.</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ dont_know_percent }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {% if last_reports %}
                            <div class="col-12 col-sm-6 col-xl-4 mb-4">
                                <div class="card border-0 shadow">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center">
                                            <div class="col-12 col-xl-5 text-xl-start mb-3 mb-xl-0 d-flex align-items-start justify-content-xl-start">
                                                <h3 class="h5">This is report no:</h3>
                                            </div>
                                            <div class="col-12 col-xl-7 px-xl-0">
                                                <h3 class="fw-extrabold mb-2">{{ last_reports.id }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                            

                            <div class="mt-3 mb-3">
                                <button class="btn btn-success text-white" type="button">
                                <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                                <a href="{{ button }}">{{last_report_button_text}}{{complete_report_button_text}}</a>
                                <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                                </button>
                            </div>


                           

                            


                            {% if complete_report_button_text %}<div class="text-danger" >{{complete_warning}}</div>{% endif %}
                        <div>
                            
                            <div class="card-footer">
                                <div class="table-responsive">
                                    <h4>Reports that <b> {{username}} </b> have created:</h4>
                                    <table class="table table-centered table-nowrap mb-0 rounded">
                                        <thead class="thead-light">
                                            <tr>
                                                <th class="border-0">Report#</th>
                                                <th class="border-0">Compnay</th>
                                                <th class="border-0">Action</th>                                                
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Item -->
                                            {% for report in reports %}
                                            <tr>                                                
                                                <td class="border-0 font-weight-bold">Report#{{report.id}}</td>
                                                <td class="border-0 font-weight-bold">{{report.orgonization}}</td>

                                                <td class="border-0 font-weight-bold col-auto d-flex "> 
                                                    
                                                        {% if report.report_genarated %}  
                                                        <a class="btn btn-success m-2" href="{{ report.get_absolute_url }}" target="_blank"> View </a> 
                                                        {% else %}
                                                       <span class="btn btn-outline-success m-2">Report Pending</span> 
                                                        {% endif %}
                                                    
                                                    
                                                        {% if report.creator.id == user.id %}  
                                                        <a class="btn btn-success m-2" href="{% url 'evaluation:eva_question' report.id report.last_slug %} " target="_blank"> Edit </a> 
                                                        {% else %}    
                                                        <span class="btn btn-outline-success m-2"> Creator Can Edit</span> 
                                                        {% endif %}                                                   
                                                    
                                                </td>    
                                                
                                                                                             
                                            </tr>
                                            {% endfor %}
                                            <!-- End of Item -->
                                            
                                            
                                            
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!--for last report -->                            
                            {% endif %}
                        </div>                       
                    </div>
                </div>


                {% if not last_reports %}

                <div class="row justify-content-center d-xl-flex mt-3">    

                    <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:user_settings' %}">
                                         
                            <div class="card border-0 shadow">
                                <div class="card-body mx-auto">  
                                    {{ accounts_seting }}
                                    
                                </div>
                            </div>                    
                    
                    </a>

                    <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:dashboard' %}">
                                              
                                <div class="card border-0 shadow">
                                    <div class="card-body mx-auto">  
                                        {{ dashboard }}
                                        
                                    </div>
                                </div>                    
                        
                        </a>

                        <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:change_pass' %}">
                                                
                                    <div class="card border-0 shadow">
                                        <div class="card-body mx-auto">  
                                            {{ change_pass }}
                                            
                                        </div>
                                    </div>                    
                            
                            </a>
                            <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:home' %}">
                                                      
                                        <div class="card border-0 shadow">
                                            <div class="card-body mx-auto">  
                                                {{ homepage }}
                                                
                                            </div>
                                        </div>                    
                                
                                </a>
                </div>
                {% endif %}
            
        </div>



       









    </main>
    {% endblock %}

    {% block footer %}
    {% include 'includes/g_footer.html' %}
    {% endblock %}



</body>

</html>