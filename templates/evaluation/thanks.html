{% extends "includes/g_base.html" %}

{%load static %} 
    
    {% block header %}
    {% block title %}{{site_info.title}}{% endblock %}
    {% include 'includes/g_header.html' %} 
    {% endblock %}
    {% block main %}
    <main>
        
        
        {% include "includes/hero_section.html" %}
        <div class="section pt-7 bgjessica-light">
            <div class="container mt-n10 mt-lg-n12 z-2">
                <div class="row justify-content-center">
                    <h1 class="d-none">User Profile or thank you page</h1>
                    {% if messages %}
                    <div class="alert alert-secondary mt-5" role="alert">
                        {% for message in messages %}
                        <span class="alert-inner--text">{{ message }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                    {% if donotshow == 'no' %}
                    <div class="col-12">
                        <div class="row g-3 mb-3">
                            <div class="col-12 col-lg-4 d-flex ">
                                <div class="card border-0 shadow flex-fill bgjessica-light">
                                    <div class="card-body">
                                        <div class="row d-block d-lg-flex align-items-center "
                                            style="min-height: 200px; overflow:hidden;">
                                            <img src="{% static user.usertype.icon.url %}"
                                                class="rounded-circle mx-auto d-block  w-50 img-fluid " alt="{{user.username}}" title="{{user.username}}" width="auto" height="auto">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-lg-8 d-flex ">
                                <div class="card border-0 shadow flex-fill bgjessica-light">
                                    <div class="card-body">
                                        <div class="row d-block d-xl-flex align-items-center"
                                            style="min-height: 200px;">
                                            <div class="col-12">
                                                <div class="d-block d-lg-flex">
                                                    <div class="col-12 col-lg-6">
                                                        <h5>
                                                            {% if user.get_full_name %}
                                                            <span>{{ user.get_full_name }}</span>
                                                            {% else %}
                                                            There is no name
                                                            {% endif %}
                                                            <span>
                                                                <a href="{% url 'home:user_settings' %}">
                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                        viewBox="0 0 24 24" data-supported-dps="24x24"
                                                                        fill="currentColor" class="mercado-match"
                                                                        width="24" height="24" focusable="false">
                                                                        <path
                                                                            d="M21.13 2.86a3 3 0 00-4.17 0l-13 13L2 22l6.19-2L21.13 7a3 3 0 000-4.16zM6.77 18.57l-1.35-1.34L16.64 6 18 7.35z">
                                                                        </path>
                                                                    </svg>
                                                                </a>
                                                            </span>
                                                        </h5>
                                                    </div>
                                                    <div class="col-auto">
                                                        <div class="text-info d-block oveflow-hidden">
                                                            {% if request.user.is_authenticated %}
                                                            {% if request.user.is_producer or request.user.is_staff or  request.user.is_superuser %}
                                                            <a href="{% url 'evaluation:evaluation2' %}"
                                                                class="me-2">Begin Evaluating</a>
                                                            {% endif %}
                                                            {% if request.user.is_marine or request.user.is_staff or  request.user.is_superuser %}
                                                            <a href="{% url 'home:questions' %}"
                                                                class="me-2">Questions</a>
                                                            {% endif %}

                                                            {% if request.user.is_expert or request.user.is_staff or  request.user.is_superuser %}
                                                            <a href="{% url 'home:quotations' %}"
                                                                class="me-2">Quotations
                                                            </a>
                                                            {% endif %}
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class=" d-xl-flex">
                                                    <div class="col-12 col-md-6 card  border-0 bg-transparent">
                                                        <h6> {{ user.usertype.name }} </h6>
                                                        <h6> {% if user.is_expert %} ({{ user.experts_in.name }}) {% endif %}</h6>
                                                        <h6>{% if user.orgonization %}{{ user.orgonization }}{% else %} There is no organization {% endif %} </h6>
                                                    </div>
                                                    <div class="col-12 col-md-6 card  border-0 bg-transparent">
                                                        <h6>{{ user.email }} </h6>
                                                        <h6>{% if user.phone %}{{ user.phone }}{% else %} There is no  phone number {% endif %} </h6>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
                <!--About Me-->
                {% if donotshow == 'no' %}
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card text-center mb-3">
                            <div class="card-header">
                                <span class="h5">About Me</span> <span>
                                    <a href="{% url 'home:user_settings' %}">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                            data-supported-dps="24x24" fill="currentColor" class="mercado-match"
                                            width="24" height="24" focusable="false">
                                            <path  d="M21.13 2.86a3 3 0 00-4.17 0l-13 13L2 22l6.19-2L21.13 7a3 3 0 000-4.16zM6.77 18.57l-1.35-1.34L16.64 6 18 7.35z"> </path>
                                        </svg>
                                    </a>
                                </span>
                            </div>
                            <div class="card-body">
                                {% if user.get_profile.about %}
                                <p>{{user.get_profile.about}}</p>
                                {% else %}
                                <p>No information found!</p>
                                {% endif %}
                            </div>
                            <div class="card-footer">
                                <div class="d-flex justify-content-between">
                                    <div class="text-mute">
                                        Location: {% if user.get_profile.location %} {{ user.get_profile.location }} {% else %} No location found {% endif %}
                                    </div>
                                    <div class="text-mute">
                                        EST.: {% if user.get_profile.established %} {{ user.get_profile.established }} {% else %} No date found {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                <!--About Me-->



                <!--Summary Boxes-->
                <div id="ques" class="row justify-content-center mb-3">
                    <div class="col-12">
                        <div class="card text-center bg-gradient bg-success">
                            <div class="card-header bg-dgreen">
                                <h2 class="text-light">{{ gretings }}</h2> 
                                <div class="text-warning">{{complete_warning}}</div> 
                                {% if complete_report_button_text %}
                                <div class="mt-3 mb-3">
                                    <button class="btn btn-secondary" type="button">
                                        <span class="spinner-grow spinner-grow-sm" role="status"
                                            aria-hidden="true"></span>
                                        <a href="{{ button }}">{{last_report_button_text}}{{complete_report_button_text}}</a>
                                        <span class="spinner-grow spinner-grow-sm" role="status"
                                            aria-hidden="true"></span>
                                    </button>
                                </div>  
                                {% endif %}                             
                            </div>
                            <div class="card-body">
                                <!--for last report -->
                            {% if last_reports %}
                            <div class="row g-3 p-3  justify-content-center">
                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bgjessica-primary">
                                        <div class="card-body">
                                            <div class="row d-block  ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">Number of questions responded</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2 h5 p-3 rounded bg-primary text-light">{{ ans_ques }}</h3> 
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bgjessica-light-primary">
                                        <div class="card-body">
                                            <div class="row d-block ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">Number of "Don't know" responses.</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2 h5 p-3 rounded bg-dark text-light">{{ dont_know_ans }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bg-dgreen">
                                        <div class="card-body">
                                            <div class="row d-block ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">Number of positive responses Received.</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2 h5 p-3 rounded bg-bgreen text-light">{{ pos_ans }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bg-dgreen">
                                        <div class="card-body">
                                            <div class="row d-block  ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">The Percentage of positive response.</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2 h5 p-3 rounded bgjessica-primary text-light">{{ positive_percent }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bg-primary">
                                        <div class="card-body">
                                            <div class="row d-block  ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">Percentage of "Don't know" response.</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2  h5 p-3 rounded bg-dark text-light">{{ dont_know_percent }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                              
                                <div class="col-12 col-sm-6 col-xl-4 d-flex">
                                    <div class="flex-fill card bg-danger">
                                        <div class="card-body">
                                            <div class="row d-block ">
                                                <div class="col-12 ">
                                                    <h3 class="h5 text-light">The reference number of the Report:</h3>
                                                </div>
                                                <div class="col-12 ">
                                                    <h3 class="fw-extrabold mb-2 h5 p-3 rounded bg-warning text-primary">{{ last_reports.id }}</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                             


                            </div>                            
                            {% endif %}
                            <!--for last report -->

                            </div>
                        </div>
                    </div>
                </div>
                <!--Summary Boxes-->
                
                <!--Traffic Light OVerview-->
                <div id="labeldata" class="row justify-content-center mb-3">
                    <div class="col-12">
                        <div class="card text-center bgjessica-light-primary">
                            <div class="card-header bgjessica-primary2 text-primary">
                                <h2 class="text-light">Traffic-light overview of Report #{{ last_reports.id }}</h2>                                
                            </div>

                            
                            
                            <div class="row g-3 p-3  justify-content-center " >

                                <div hx-get="{% url 'evaluation:traficlighthori' last_reports.id %}" hx-trigger="load">
                                    <div class="card text-center mb-4 mt-4">                                
                                        <div class="row p-3 justify-content-center">
                                        Loading traffic light overview...
                                        </div>
                                    </div>    
                                </div>

                            <!--
                                <div class="card-body p-2">                                    
                                    <div id="sss" class="ct-chart-ranking ct-golden-section ct-series-a">
                                        
                                    </div>
                                </div>
                            -->
                            </div>
                            
                        </div>
                    </div>
                </div>
                <!--Traffic Light ovrview-->
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card text-center">                            
                            <!--for last report -->
                            {% if last_reports %}
                            <div class="row g-3 p-3  justify-content-center">
                                <div>
                                    <div class="card-footer">
                                        <div class="table-responsive">
                                            <h4>Reports that <b> {{username}} </b> have created:</h4>
                                            <table class="table table-centered table-nowrap mb-0 rounded">
                                                <thead class="thead-light">
                                                    <tr>
                                                        <th class="border-0">Report#</th>
                                                        <th class="border-0">Compnay</th>
                                                        <th class="border-0">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Item -->
                                                    {% for report in reports %}
                                                    <tr>
                                                        <td class="border-0 font-weight-bold">Report#{{report.id}}</td>
                                                        <td class="border-0 font-weight-bold">{{report.orgonization}} </td>
                                                        <td class="border-0 font-weight-bold col-auto d-flex ">
                                                            {% if report.report_genarated %}
                                                            <a class="btn btn-primary btn-sm m-2"
                                                                href="{{ report.get_absolute_url }}" target="_blank">
                                                                View 
                                                            </a>
                                                            <form action="{% url 'accounts:user_link' user.username %}#labeldata" method="get">
                                                                <input type="hidden" name="slug"  value="{{report.slug}}">
                                                                <input type="submit" class="btn btn-primary btn-sm m-2" value="See Summary">
                                                            </form>
                                                            {% else %}
                                                            <span class="btn btn-outline-primary btn-sm m-2">Pend</span>
                                                            {% endif %}
                                                            {% if report.creator.id == user.id or user.is_superuser %}
                                                            <a class="btn btn-primary btn-sm m-2" href="{% url 'evaluation:eva_question' report.id report.last_slug %} " target="_blank"> Edit </a>
                                                            {% else %}
                                                            <span class="btn btn-outline-primary btn-sm m-2"> Creator Can Edit</span>
                                                            {% endif %}
                                                        </td>
                                                    </tr>
                                                    {% endfor %}
                                                    <!-- End of Item -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>                                    
                                </div>
                            </div>                            
                            {% endif %}
                            <!--for last report -->
                        </div>


                        {% if not last_reports %}
                        <div class="row justify-content-center d-xl-flex mt-3">
                            <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:user_settings' %}">
                                <div class="card border-0 shadow">
                                    <div class="card-body mx-auto">
                                        {{ accounts_seting }}
                                    </div>
                                </div>
                            </a>
                            <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:dashboard' %}">
                                <div class="card border-0 shadow">
                                    <div class="card-body mx-auto">
                                        {{ dashboard }}
                                    </div>
                                </div>
                            </a>

                            <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:change_pass' %}">
                                <div class="card border-0 shadow">
                                    <div class="card-body mx-auto">
                                        {{ change_pass }}
                                    </div>
                                </div>
                            </a>
                            <a class="col-12 col-sm-6 col-xl-4 mb-4" href="{% url 'home:home' %}">
                                <div class="card border-0 shadow">
                                    <div class="card-body mx-auto">
                                        {{ homepage }}
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endif %}
                    </div>    
                </div>  
            </div>
        </div>              
                                   
    </main>
   
    {% endblock %}
    {% block footer %}
    {% include 'includes/g_footer.html' %}
    {% endblock %}
    

    {% block javascripts %}


   
    {% endblock javascripts %}

