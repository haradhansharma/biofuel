<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Haradhan Sharma">
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Evaluation - GFVP Docs</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-success">
            <div class="container">
                <a class="navbar-brand" href="index.html">GFVP Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="index.html" class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="accounts.html" class="nav-link">Accounts</a>
                            </li>
                            <li class="navitem">
                                <a href="crm.html" class="nav-link">CRM</a>
                            </li>
                            <li class="navitem">
                                <a href="blog.html" class="nav-link">Blog</a>
                            </li>
                            <li class="navitem active">
                                <a href="evaluation.html" class="nav-link">Evaluation</a>
                            </li>
                            <li class="navitem">
                                <a href="guide.html" class="nav-link">Guide</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="blog.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="guide.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/haradhansharma/biofuel/blob/main/docs/evaluation.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#welcome_to_the_evaluation_docs" class="nav-link">Welcome to The evaluation DOCS</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#apps_layout" class="nav-link">Apps layout</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#custom_template_tags" class="nav-link">Custom template Tags</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#evaluation_admin" class="nav-link">Evaluation Admin</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#app" class="nav-link">APP</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#form" class="nav-link">Form</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#helper" class="nav-link">Helper</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#model" class="nav-link">Model</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="welcome_to_the_evaluation_docs">Welcome to The evaluation DOCS<a class="headerlink" href="#welcome_to_the_evaluation_docs" title="Permanent link">&para;</a></h1>
<h2 id="apps_layout">Apps layout<a class="headerlink" href="#apps_layout" title="Permanent link">&para;</a></h2>
<pre><code>Web Root        # The main folder of the web project.
    evaluation/
        templatestags #Written django's custom template tag to serve in the template
        admin.py
        apps.py
        forms.py
        helper.py  
        middleware # Custom Django's midleware  
        models.py
        nreport_class.py # Custom algorthm to build traffic-light overview
        signals.py
        tests.py
        urls.py
        views.py
        ...
</code></pre>
<h2 id="custom_template_tags">Custom template Tags<a class="headerlink" href="#custom_template_tags" title="Permanent link">&para;</a></h2>
<ul>
<li><code>{% load custom_tags %}</code> - To load Custom template tags in the HTML file</li>
<li><code>{{ question.sort_order | brek_after_two}}</code> - To break line after first two word of the questions's sort order. It is not used now.</li>
<li><code>get_verbose_name(instance, field_name)</code> - It is using to build quotation report in function base view. It takes model instance and field name as parameter and return the verbose name of the field. It can be used in the template as well acroding tot he django's document.</li>
<li><code>in_quot(quote, user)</code> - This tag returns the quotations created by the user as service provider. Example use case: <code>{% if child.get_quotations|in_quot:user %}</code> to get all quotation of the user.</li>
</ul>
<h2 id="evaluation_admin">Evaluation Admin<a class="headerlink" href="#evaluation_admin" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Every class and features in the <code>admin.py</code> based on django's regular facility. Some exceptional in our case are mentoning here:</p>
</blockquote>
<pre><code>class Media:
    css = {
        'all': (
            '/static/css/fancy.css',
        )
    }
</code></pre>
<blockquote>
<p>Adding custom css using above code in admin class </p>
</blockquote>
<pre><code>change_list_template = 'admin/question_list.html'
def changelist_view(self, request, extra_context=None):        
    questions = Question.objects.filter(is_active = True)
    label_pending_in_question = [q.sort_order for q in questions if not q.have_4labels]  
    problem_in_options =   [q.sort_order for q in questions if not q.problem_in_option]       
    extra_context = extra_context or {}
    extra_context['label_pending_in_question'] = label_pending_in_question
    extra_context['problem_in_options'] = problem_in_options        
    return super().changelist_view(request, extra_context=extra_context)
</code></pre>
<blockquote>
<p>Adding error note using above by oerriding instance and method in the admin class of question.</p>
</blockquote>
<pre><code>@admin.action(description='Genarate updated report and notify to the creator')
def check_and_notify(self, request, queryset):
    from .views import set_evastatment, set_evastatement_of_logical_string
    ........
    .........
    ReportMailQueue.objects.create(
            to = i.email,
            from_report = i,
            new_report = copy_evaluator,
        )
</code></pre>
<blockquote>
<p>Above method are adding action in Evaluator(Evaluator is the alternative coding name of human readable Report). The action should be called by admin on "Pening" marked report. Pending mark also a custom adition in admin interface which is described in the <code>models.py</code> in this documentation.</p>
<p>Each call in above method create mail queue to send mail on next cronjob execution.</p>
</blockquote>
<pre><code>class NextActivitiesAdmin(admin.ModelAdmin):  
    @admin.action(description='Duplicate Selected Activities')
    def duplicate_event(modeladmin, request, queryset):
        for object in queryset:
            ..........         
    actions = [duplicate_event]
admin.site.register(NextActivities, NextActivitiesAdmin)
</code></pre>
<blockquote>
<p>Above aditional method in class creating a additional action to clone the selected objects in the <code>NextActivities</code> model in the admin side.</p>
</blockquote>
<h2 id="app">APP<a class="headerlink" href="#app" title="Permanent link">&para;</a></h2>
<blockquote>
<p>App is a configuration file of evaluation app provided by Django. Here <code>signals.py</code> has been registered using below code. </p>
</blockquote>
<pre><code>def ready(self):
    import evaluation.signals
</code></pre>
<blockquote>
<p>Do not change anything in this file.</p>
</blockquote>
<h2 id="form">Form<a class="headerlink" href="#form" title="Permanent link">&para;</a></h2>
<p><code>forms.py</code> inheriting the default django's <code>ModelForm</code> class for evaluation initialization based on our CSS library. We are using <code>bootstrap 5</code>. Implemented <code>HTMX</code> to find out fuel grade based on selected biofuel.</p>
<h2 id="helper">Helper<a class="headerlink" href="#helper" title="Permanent link">&para;</a></h2>
<p>Helper playing a vast role in the evaluation application</p>
<pre><code>    def active_sessions():
        '''
        we will collect all active session's evaluator id of before past 24 hours
        it returns list
        '''

        return list(s_evs)
</code></pre>
<p>The above <code>active_session</code> function collect all active sessions before 24 hours and it is calling through <code>cronjob</code> inside below function.</p>
<pre><code>    def clear_evaluator():
        '''
        IT IS RUNNING BY CRON JOB
        we will remove all wastage report which just initialized but have no data and which is not qualified to show in the profile page.
        It returns total deleted report in a call.
        It is created to call by CRONJOB but can be called from anywhere.

        '''

        return total_deleted
</code></pre>
<p>The <code>clear_evaluator</code> works as per <code>code cooments</code> mentioned inside the function.</p>
<p><code>from evaluation.helper import get_current_evaluator</code> provide the current evaluator objects to use in anywhere. It taks one parameter is <code>request</code>. needless to say that evaluator is <strong>result</strong> of evaluation process, which can be called as <strong>report</strong> as well. It is a bit confusing. But after developing basement and database here some diferent types of advise so that I had to adjust. In this planform have some manymore like that. But will be explained.</p>
<blockquote>
<p><code>label_assesment_for_donot_know</code>, <code>label_assesment_for_positive</code>, <code>overall_assesment_for_donot_know</code>, <code>overall_assesment_for_positive</code> These methods commit some assesments indivisually for answere type in the <strong>evalautor</strong> as statement. All these like manual assesment and never using anywhere other then report genaration so that no DRF thingking were here.</p>
<p>The functions can be wrapped into the class and can be optimized as well, but as we are under development stage and many more to develop yet so it will be later. Some of method called inside these methods can be called from <code>LabelWiseData</code> class below as well.</p>
</blockquote>
<p><code>from evaluation.helper import OilComparision</code>'s <code>packed_labels</code> returns  <code>pandas</code> dataframe of Related Fuel grade. <code>picked_labels_dict</code> return the dictionery of labels. Here have many other methods to use. The class takes compulsary parameter named <code>oil</code>. The dataframe currently using in the <code>chartistjs</code> to show in the evaluation form and t use in further advise.</p>
<p><code>from evaluation.helper import LabelWiseData</code>'s <code>packed_labels</code> return <code>pandas</code> dataframe of biofuel and <code>label_data_history</code> returns the dataframe of the history of biofuel reports in various stage. <code>picked_labels_dict</code> return the dictionery of labels. Here have many more methods to use. The class takes compulsary parameter named <code>evaluator</code>. </p>
<p><code>nreport_context</code> function of helper is returning the context for HTML evaluation report. It takes <code>request</code> and <code>slug</code> parameter as compulsary. The function directly call from the <code>view</code> function of the HTML report.</p>
<h2 id="model">Model<a class="headerlink" href="#model" title="Permanent link">&para;</a></h2></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(c) gf-vp.com</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
